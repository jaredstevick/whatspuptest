"use strict";angular.module("whatsPup",["ngAnimate","ngCookies","ngTouch","ngSanitize","restangular","ui.router","ui.bootstrap","firebase"]).constant("FIREBASE_URL","https://whatspup.firebaseio.com/").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("home",{url:"/",templateUrl:"app/view/main.html",controller:"AuthCtrl",controllerAs:"app"}).state("client",{url:"/client",templateUrl:"app/view/addclient.html",controller:"AddClientCtrl",controllerAs:"client"}).state("navbar",{url:"/nav",templateUrl:"app/view/navbar.html",controller:"NavCtrl",controllerAs:"nav"}).state("owner",{url:"/owner",templateUrl:"app/view/ownerpage.html",controller:"OwnerBtnCtrl",controllerAs:"ownerbtn"}).state("newvisit",{templateUrl:"app/view/newvisit.html",url:"/newvisit/:user/:clientId",controller:"NewVisitCtrl",controllerAs:"newvisit"}),t.otherwise("/")}]).factory("Auth",["$firebaseObject","$state",function(e,t){function l(t){if(console.log(t),null===t)return null;console.log("This will break if you login with anything other than FB");var l=a.child("petsitter").child(t.facebook.id);return console.log(l),l.update({uid:t.facebook.id,facebook:t.facebook,fullName:t.facebook.displayName,firstName:t.facebook.cachedUserProfile.first_name,lastName:t.facebook.cachedUserProfile.last_name,avatarUrl:t.facebook.cachedUserProfile.picture.data.url,gender:t.facebook.cachedUserProfile.gender}),l=e(a.child("petsitter").child(t.facebook.id)),i=l,l}var a=new Firebase("https://whatspup.firebaseio.com"),i={};return{onAuth:function(e){a.onAuth(function(t){e(l(t))})},sitterlogin:function(){return a.authWithOAuthPopup("facebook",function(e,l){e?console.log("Login Failed!",e):(t.go("client"),console.log("Authenticated successfully with payload:",l))},{remember:"sessionOnly"})},logout:function(){a.unauth(),t.go("home"),console.log("hello")},loggedIn:function(){return a.getAuth()?!0:void 0},getUser:function(){return i}}}]),angular.module("whatsPup").controller("OwnerBtnCtrl",["$firebaseArray","$firebaseObject","Auth","$state",function(e,t,l,a){var i=new Firebase("https://whatspup.firebaseio.com/");this.ownerlogin=function(){return i.authWithOAuthPopup("facebook",function(e,t){e?console.log("Login Failed!",e):(a.go("owner"),console.log("Authenticated successfully with payload:",t))},{remember:"sessionOnly"})},l.onAuth(function(e){self.user=e,console.log(null===e?"null":e)})}]),angular.module("whatsPup").controller("NewVisitCtrl",["Auth","$state","$stateParams","$firebaseObject","$http",function(e,t,l,a,i){var s=this;this.loggedIn=e.loggedIn;var o=new Firebase("https://whatspup.firebaseio.com/Clients/"+l.user+"/"+l.clientId);this.visitObj=a(o),this.visitObj.$loaded().then(function(e){return s.getEmail=e.email}),this.image="",document.getElementById("upload_widget_opener").addEventListener("click",function(){console.log("opened"),cloudinary.openUploadWidget({cloud_name:"jaredstevick",upload_preset:"xnpszqid"},function(e,t){return console.log(t[0].url),s.image=t[0].url,s.image})},!1);var n=new Date,c=n.getMonth()+1+"/"+n.getDate()+"/"+n.getFullYear()+" at "+n.getHours()+":"+n.getMinutes();this.sentEmail=function(){console.log(this.image),i({method:"POST",url:"https://mandrillapp.com/api/1.0/messages/send-template.json",data:{key:"SjfF7oGr1BHLUnBlnSF20A",template_name:"whatspup1",template_content:[{name:"example name",content:"example content"}],message:{from_email:"whatspupupdate@gmail.com",from_name:"WhatsPup",headers:{"Reply-To":"whatspupupdate@gmail.com"},subject:"New Visit Update from WhatsPup",to:[{email:this.getEmail,name:"name",type:"to"}],global_merge_vars:[{name:"time",content:c},{name:"food",content:this.food},{name:"water",content:this.water},{name:"play",content:this.play},{name:"treats",content:this.treats},{name:"meds",content:this.meds},{name:"mess",content:this.mess},{name:"packages",content:this.packages},{name:"mail",content:this.mail},{name:"plants",content:this.plants},{name:"other",content:this.other},{name:"message",content:this.message},{name:"image",content:this.image}]}}}).success(function(e){alert("The visit has been saved. Thank you!"),console.log(e)}).error(function(){alert("There was a problem sending the visit.")})}}]),angular.module("whatsPup").controller("NavCtrl",["Auth",function(e){this.logout=e.logout,this.loggedIn=e.loggedIn}]),angular.module("whatsPup").controller("AuthCtrl",["$firebaseArray","$firebaseObject","Auth",function(e,t,l){new Firebase("https://whatspup.firebaseio.com/");this.sitterlogin=l.sitterlogin}]),angular.module("whatsPup").controller("NavbarCtrl",["$scope",function(e){e.date=new Date}]),angular.module("whatsPup").controller("AddClientCtrl",["$firebaseArray","$firebaseObject","Auth","$state","$stateParams",function(e,t,l){var a=this,i=(l.onAuth(function(e){return a.user=e,null!==e?(console.log(e.$id),e.$id):void console.log("null")}),new Firebase("https://whatspup.firebaseio.com/Clients/"+a.user.$id));this.loggedIn=l.loggedIn;var s=i.getAuth();s&&console.log("Authenticated user with uid:",s.uid),this.obj=e(i),this.userArray={},this.newClient={name:"",pet:"",email:"",phone:"",street:"",city:"",state:"",zip:"",sitterUid:a.user.$id},this.addClient=function(e){return this.obj.$add(e),this.newClient={name:"",pet:"",email:"",phone:"",street:"",city:"",state:"",zip:"",sitterUid:""}},this.deleteClient=function(e){var t=new Firebase("https://whatspup.firebaseio.com/Clients/"+a.user.$id+"/"+e.$id);t.remove()}}]),angular.module("whatsPup").run(["$templateCache",function(e){e.put("app/view/addclient.html",'<div class="blue-mask"></div><div class="container-fluid cd-fixed-bg cd-bg-1"><form class="form-horizontal" ng-submit="client.addClient(client.newClient)"><fieldset class="fieldsettings"><div class="row"><a href="" ng-show="show" ng-click="show=! show" class="col-md-11 pull-right"><button id="Cancel" name="Cancel" class="btn btn-danger btn-lg pull-right">cancel</button></a> <a href=""><button ng-hide="show" ng-click="show=! show" class="btn btn-lg btn-success newClient pull-right">add client</button></a></div><div class="test" ng-show="show"><div class="col-md-5"><div class="form-group"><label class="control-label" for="name">Name</label><div class="col-md-"><input ng-model="client.newClient.name" id="name" name="name" type="text" placeholder="Full Name" class="form-control input-md"></div></div><div class="form-group"><label class="control-label" for="pet">Pet\'s Name</label><div class=""><input ng-model="client.newClient.pet" id="pet" name="pet" type="text" placeholder="Pet\'s Name" class="form-control input-md"></div></div><div class="form-group"><label class="control-label" for="email">Email</label><div class=""><input ng-model="client.newClient.email" id="email" name="email" type="text" placeholder="email@example.com" class="form-control input-md"></div></div><div class="form-group"><label class="control-label" for="phone">Phone Number</label><div class=""><input ng-model="client.newClient.phone" id="phone" name="phone" type="text" placeholder="555-867-5309" class="form-control input-md"></div></div></div><div class="col-md-2"></div><div class="col-md-5"><div class="form-group"><label class="control-label" for="address">Street Address</label><div class=""><input ng-model="client.newClient.street" id="address" name="address" type="text" placeholder="123 Street Name" class="form-control input-md"></div></div><div class="form-group"><label class="control-label" for="city">City</label><div class=""><input ng-model="client.newClient.city" id="city" name="city" type="text" placeholder="City Name" class="form-control input-md"></div></div><div class="form-group"><label class="control-label" for="state">State</label><div class=""><input ng-model="client.newClient.state" id="state" name="state" type="text" placeholder="State" class="form-control input-md"></div></div><div class="form-group"><label class="control-label" for="zip">Zip Code</label><div class=""><input ng-model="client.newClient.zip" id="zip" name="zip" type="text" placeholder="Zip Code" class="form-control input-md"></div></div></div><div class="form-group"><div class="addclient-submitbtn"><button ng-click="show = !show" id="Submit" name="Submit" class="btn btn-primary btn-lg">submit</button></div></div></div></fieldset></form><div class="clientscontainer cd-fixed-bg cd-bg-1"><hr><span class="clientlist"><h1><strong>Clients</strong></h1></span><hr><div ng-repeat="clients in client.obj" class="col-md-6 cd-fixed-bg cd-bg-1"><div class="cd-bg-1 newclienteven"><div class="cd-scrolling-bg cd-color-2"><p class="clientname"><big><strong>{{ clients.name }}</strong></big></p><p><strong>Pet:</strong> {{ clients.pet }}</p><p><strong>Phone:</strong> {{ clients.phone }}</p><p><strong>E-mail:</strong> {{ clients.email }}</p><p><strong>Address:</strong> {{ clients.street }} {{ clients.city }} {{clients.state}} {{clients.zip }}</p><a ui-sref="newvisit({user: client.user.$id, clientId: clients.$id})" class="btn btn-md btn-info newvisitbtn">new visit</a> <a ng-click="client.deleteClient(clients)" class="btn btn-md btn-danger deletebtn">delete</a><p></p></div></div></div></div></div>'),e.put("app/view/main.html",'<div class="video-container maindiv"><div class="mask"></div><video autoplay="" loop="" poster="polina.jpg" id="bgvid"><source src="http://ak8.picdn.net/shutterstock/videos/4486523/preview/stock-footage-cute-puppy-dog-slow-motion-running-across-grass-shot-over-cranked-on-red-digital-cinema-camera-at.mp4" type="video/mp4"></video></div><div class="title-container"><div class="loginform" ng-submit="client.addClient(app.newClient)"><div class="whitelogo"><p style="color: #fff" ui-sref="home"><i class="fa fa-paw" style="color: #fff"></i>whatsPup</p></div><p class="fblogin">A web application for Pet Sitters to provide real-time updates to their clients.</p><p class="fblogin">Become a member with Facebook.</p><a ng-click="app.sitterlogin()"><div class="sitterbtn"><div class="flogin-icon"><i class="fa fa-facebook"></i></div><div class="flogin-text">Login</div></div></a></div></div>'),e.put("app/view/navbar.html",'<div class="navbar navbar-inverse navbar-fixed-top" role="navigation" ng-controller="NavCtrl as nav"><div class="container"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand" ui-sref="home"><i class="fa fa-paw"></i> whatsPup</a></div><div class="navbar-collapse collapse"><ul class="nav navbar-nav pull-right"><li class=""><a href="#">About Us</a></li><li class=""><a href="#">Contact Us</a></li><li ng-show="nav.loggedIn()" class=""><a href="#" ng-click="nav.logout()">Logout</a></li></ul></div></div></div>'),e.put("app/view/newclientform.html",'<div class="container-fluid clientformctn"><form class="form-horizontal formbody"><fieldset><div class="background"><legend><h2>New Client Information</h2></legend><div class="col-md-5"><div class="form-group"><label class="control-label" for="lastName">Last Name</label><div class="col-md-"><input id="lastName" name="lastName" type="text" placeholder="Last Name" class="form-control input-md"></div></div><div class="form-group"><label class="control-label" for="firstName">First Name</label><div class=""><input id="firstName" name="firstName" type="text" placeholder="First Name" class="form-control input-md"></div></div><div class="form-group"><label class="control-label" for="pet">Pet\'s Name</label><div class=""><input id="pet" name="pet" type="text" placeholder="Pet\'s Name" class="form-control input-md"></div></div><div class="form-group"><label class="control-label" for="email">Email</label><div class=""><input id="email" name="email" type="text" placeholder="email@example.com" class="form-control input-md"></div></div></div><div class="col-md-1"></div><div class="col-md-5"><div class="form-group"><label class="control-label" for="phone">Phone Number</label><div class=""><input id="phone" name="phone" type="text" placeholder="555-867-5309" class="form-control input-md"></div></div><div class="form-group"><label class="control-label" for="address">Street Address</label><div class=""><input id="address" name="address" type="text" placeholder="123 Street Name" class="form-control input-md"></div></div><div class="form-group"><label class="control-label" for="city">City</label><div class=""><input id="city" name="city" type="text" placeholder="City Name" class="form-control input-md"></div></div><div class="form-group"><label class="control-label" for="zip">Zip Code</label><div class=""><input id="zip" name="zip" type="text" placeholder="12345" class="form-control input-md"></div></div></div><div class="form-group"><div class="col-md-6"><button id="Submit" name="Submit" class="btn btn-primary btn-lg pull-right">submit</button></div></div></div></fieldset></form></div>'),e.put("app/view/newvisit.html",'<div class="container" ng-controller="NewVisitCtrl as newvisit"><section id="users" style="padding-top: 5em; text-align: center"><hr><div><h2 style="color: #fff">{{newvisit.visitObj.name}}</h2></div></section><hr><form class="form-horizontal newVisit" name="visitForm" id="clientVisit" ng-submit="clientVisit.submitForm"><fieldset><div class="newvisitctn"><div class="col-md-5"><div class="form-group"><label class="col-md-4 control-label" for="email">E-mail</label><div class="col-md-7"><input ng-model="newvisit.getEmail" value="{{newvisit.getEmail}}" type="email" class="col-md-4 text-center form-control" id="exampleInputEmail1"></div></div><div class="form-group"><label class="col-md-4 control-label" for="food">Fresh Food and Water</label><div class="col-md-4"><div class="checkbox"><label for="food-0"><input type="checkbox" name="food" id="food-0" value="Food" ng-model="newvisit.food"> Food</label></div><div class="checkbox"><label for="water"><input type="checkbox" name="water" id="water" value="Water" ng-model="newvisit.water"> Water</label></div></div></div><div class="form-group"><label class="col-md-4 control-label" for="play">Playtime or Walk Duration</label><div class="col-md-8"><select id="play" name="play" class="form-control" ng-model="newvisit.play"><option value="N/A">N/A</option><option value="5 Minutes">5 Minutes</option><option value="10 Minutes">10 Minutes</option><option value="15 Minutes">15 Minutes</option><option value="20 Minutes">20 Minutes</option><option value="25 Minutes">25 Minutes</option><option value="30 Minutes">30 Minutes</option></select></div></div><div class="form-group"><label class="col-md-4 control-label" for="treats">Treats</label><div class="col-md-4"><div class="checkbox"><label for="treats"><input type="checkbox" name="treats" id="treats" ng-model="newvisit.treats"> Yes</label></div></div></div><div class="form-group"><label class="col-md-4 control-label" for="meds">Medications</label><div class="col-md-8"><select id="meds" name="meds" class="form-control" ng-model="newvisit.meds"><option value="N/A">N/A</option><option value="Yes">Yes</option></select></div></div></div><div class="col-md-1"></div><div class="col-md-5 col2visit"><div class="form-group"><label class="col-md-4 control-label" for="misc">Miscellaneous Tasks</label><div class="col-md-8"><div class="checkbox"><label for="misc-0"><input type="checkbox" name="misc" id="misc-0" value="Cleaned Up Pet Mess" ng-model="newvisit.mess"> Cleaned Up Pet Mess</label></div><div class="checkbox"><label for="misc-1"><input type="checkbox" name="misc" id="misc-1" value="Packages Moved Inside" ng-model="newvisit.packages"> Packages Moved Inside</label></div><div class="checkbox"><label for="misc-2"><input type="checkbox" name="misc" id="misc-2" value="Picked Up Mail" ng-model="newvisit.mail"> Picked Up Mail</label></div><div class="checkbox"><label for="misc-3"><input type="checkbox" name="misc" id="misc-3" value="Watered Plants" ng-model="newvisit.plants"> Watered Plants</label></div><div class="checkbox"><label for="misc-4"><input type="checkbox" name="misc" id="misc-4" value="Other (See Message)" ng-model="newvisit.other"> Other (See Message)</label></div></div></div><div class="form-group"><label class="col-md-4 control-label" for="message">Message</label><div class="col-md-8"><textarea class="form-control" id="message" placeholder="Write your message here..." ng-model="newvisit.message"></textarea></div></div><div class="pull-right"><a href="" id="upload_widget_opener">Upload images</a></div></div><div class="form-group"><div class="newvisit-submitbtn"><button ui-sref="client" ng-click="newvisit.sentEmail()" type="submit" id="submit" class="btn btn-primary btn-lg" value="Submit">Submit</button></div></div></div></fieldset></form></div>'),e.put("app/view/ownerbutton.html",'<a ng-click="ownerbtn.ownerlogin(); ownerbtn.updateOwner(refdUser);" ng-controller="OwnerBtnCtrl as ownerbtn"><div class="ownerbtn">I\'m a Pet Owner</div></a>'),e.put("app/view/ownerpage.html","<p>hello world!</p>"),e.put("components/navbar/navbar.html",'<nav class="navbar navbar-static-top navbar-inverse" ng-controller="NavbarCtrl"><div class="container-fluid"><div class="navbar-header"><a class="navbar-brand" href="https://github.com/Swiip/generator-gulp-angular"><span class="glyphicon glyphicon-home"></span> Gulp Angular</a></div><div class="collapse navbar-collapse" id="bs-example-navbar-collapse-6"><ul class="nav navbar-nav"><li class="active"><a ng-href="#">Home</a></li><li><a ng-href="#">About</a></li><li><a ng-href="#">Contact</a></li></ul><ul class="nav navbar-nav navbar-right"><li>Current date: {{ date | date:\'yyyy-MM-dd\' }}</li></ul></div></div></nav>')}]);